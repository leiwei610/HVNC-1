name: HVNC-1 官方标准复制产物
on: [push, workflow_dispatch]
jobs:
  build:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - uses: microsoft/setup-msbuild@v2
      
      # 1. 官方命令：强制编译到临时目录
      - name: 编译Client（官方强制输出路径）
        run: msbuild Client/HVNC.vcxproj /p:Configuration=Release /p:Platform=x64 /p:OutDir=${{ github.workspace }}/build_output/Client/ /nologo
      
      - name: 编译Server（官方强制输出路径）
        run: msbuild Server/Server.vcxproj /p:Configuration=Debug /p:Platform=Win32 /p:OutDir=${{ github.workspace }}/build_output/Server/ /nologo
      
      # 2. 标准命令：复制到你要的output文件夹
      - name: 复制产物到output（标准命令）
        run: |
          New-Item -Path ${{ github.workspace }}/output -ItemType Directory -Force
          Copy-Item -Path ${{ github.workspace }}/build_output/**/*.exe -Destination ${{ github.workspace }}/output/ -Recurse -Force
      
      # 3. 验证文件存在（官方标准步骤）
      - name: 验证output中的文件
        run: Get-ChildItem ${{ github.workspace }}/output -Name
      
      # 4. 上传产物（官方标准步骤）
      - name: 上传output文件夹
        uses: actions/upload-artifact@v4
        with:
          name: HVNC-1-标准产物包
          path: ${{ github.workspace }}/output/
